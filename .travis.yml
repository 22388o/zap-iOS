branches:
  except:
  - localization
osx_image: xcode11.1
language: objective-c
xcode_workspace: Zap.xcworkspace
xcode_scheme: Zap
cache: bundler
addons:
  homebrew:
    packages:
    - graphicsmagick
git:
  quiet: true
  depth: 3
notifications:
  email:
    on_success: never
    on_failure: change
install:
  - bundle install
  - carthage bootstrap --platform iOS
stages:
  - test
  - name: deploy
    #if: 'branch = master AND tag IS present'
jobs:
  include:
#    - stage: test        
#      script: bundle exec fastlane tests
#      after_success:
#        - bash <(curl -s https://codecov.io/bash) -J 'Library' -J 'Lightning'
    - stage: deploy
      script: bundle exec fastlane testnet
      name: "Deploy Testnet"
#    - script: bundle exec fastlane mainnet
#      name: "Deploy Mainnet"
#    - script: bundle exec fastlane release
#      name: "Deploy Appstore"
